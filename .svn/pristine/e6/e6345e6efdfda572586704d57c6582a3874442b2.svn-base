<%@ Page Language="C#" MasterPageFile="~/ControlPanel/CPMaster.Master" AutoEventWireup="true"  CodeBehind="ListFamily.aspx.cs" Inherits="SaveDC.ControlPanel.ListFamily" Title="List Family"%>
<%@ Register Src="Controls/AdvDataPager.ascx" TagName="DataPager" TagPrefix="uc1" %>

<asp:Content ID="Content1" ContentPlaceHolderID="ContentPlaceHolder1" runat="server">
    <script type="text/javascript" language="javascript">

        function ValidateAction() {

            if (confirm("Are you sure, you want to delete this family?"))
                return true;
            else
                return false;
        }

        function SelectOne(rdo, gridName) {
            /* Getting an array of all the "INPUT" controls on the form.*/
            all = document.getElementsByTagName("input");
            for (i = 0; i < all.length; i++) {
                if (all[i].type == "radio")/*Checking if it is a radio button*/ {
                    var count = all[i].id.indexOf(gridName);
                    if (count != -1) {
                        all[i].checked = false;
                    }
                }
            }
            rdo.checked = true; /* Finally making the clicked radio button CHECKED */
            document.getElementById('<%= hdnFamilyID.ClientID %>').value = rdo.value;
            //alert(document.getElementById("ctl00_ContentPlaceHolder1_hdnFamilyID").value);
        }


        function SelectFirst(gridName) {
            /* Getting an array of all the "INPUT" controls on the form.*/
            all = document.getElementsByTagName("input");
            for (i = 0; i < all.length; i++) {
                if (all[i].type == "radio")/*Checking if it is a radio button*/ {
                    var count = all[i].id.indexOf("rowbtn");
                    if (count != -1) {
                        {
                            SelectOne(all[i], gridName);
                            break;
                        }
                    }
                }
            }
        }

//     SelectFirst('dgFamilies');
</script>
    <table width="95%" cellpadding="2" cellspacing="2" border="0">
        <tr>
            <td height="20px"  class="CellLabel" colspan="2">
	
	
                <table width="100%">
                    <tr>
                        <td width="80%">
                            Family Manager :: List Families
                           
                        </td>
                        <td align="right" width="20%">
                            <asp:ImageButton ID="ImageButton1" runat="server" SkinID="sknImgBack" Height="24"
                                             Width="24" OnClientClick="javascript:window.history.back(); return false;" />
                        </td>
                    </tr>
                </table>
	
            </td>
        </tr>
        <tr>
            <td height="20px" colspan="2">This is Family Manager. Here all of your donated students families are listed with their brief details like the Father Name, Mother Name, Contact Number and number of students studying with you.
                If you want to have a detail view of the family then select the appropriate family and click on Family Details button.<br /><br />
                You can also filter specific family in the listing through Family Name or Father Name.
            </td>
        </tr>
        <tr>
            <td colspan="2">
                <asp:Label ID="lblError" runat="server" Text=""></asp:Label></td>
        </tr>
	
        <tr>
            <td colspan="1" class="CellLabel">
                <table id="Table1" runat="server" width="100%">
                    <form name="frmsearch" method="post" id="frmsearch">
                        <tr>
                            <td width="40%">
                                Family Name:
                            </td>
                            <td valign="middle">
                                <asp:TextBox CssClass="Textbox" ID="txtFamilyName" runat="server" />
                            </td>
                            <td width="70%" align="left">
                                <asp:ImageButton ID="searchbtn" runat="server" ImageUrl="search.png" Height="40"
                                                 Width="40" OnClick="searchbtn_Click" />
                            </td>
                        </tr>
                        <tr>
                            <td width="40%">
                                Father Name:
                            </td>
                            <td valign="middle">
                                <asp:TextBox CssClass="Textbox" ID="txtFatherName" runat="server" />
                            </td>
                            <td width="70%" align="left">
                        
                            </td>
                        </tr>
                    </form>
                </table>
            </td>
        </tr>
        <tr>
	
            <td colspan="2" height="10px" align="right">
                [ <a href="AddFamily.aspx">Add Family</a> ]
            </td>
        </tr>
        <tr>
            <td class="CellHeading" width="60%">Family Manager</td>
            <td class="ContextLinks" align="right">Total Families: 
                <asp:Label ID="lblTotal" runat="server" Text="0"></asp:Label>&nbsp; <%--<a id="context" href= "ListFamilies.aspx">[ List Families ]</a> <a id="context" href= "AddFamily.aspx">[ Add Family ]</a>--%>
            </td>
        </tr>
        <tr> 
            <td class="CellLabel" colspan="2">
                <table width="100%" border = 0 id="tbDataFound" runat="server">
                    <tr>
                        <td width="85%"  valign="top">
                            <asp:HiddenField runat="server" ID="hdnFamilyID" Value ="" />
                            <asp:DataGrid ID="dgFamilies" runat="server" AutoGenerateColumns="False" Width="100%" SkinID="StanderdGrid" OnItemDataBound="dgFamilies_Databound" >
                                <Columns>
                                    <asp:TemplateColumn>
                                        <HeaderTemplate>
                                        </HeaderTemplate>
                                        <ItemTemplate>
                                            <asp:RadioButton onclick="SelectOne(this,'dgFamilies')" ID="rowbtn" name="rowbtn" runat="server" Value='<%# DataBinder.Eval(Container.DataItem, "FamilyId") %>'/>
                                            <%--  <%# DataBinder.Eval(Container.DataItem, "FamilyName")%>--%>
                                        </ItemTemplate>
                                        <ItemStyle Width="3%" />
                                    </asp:TemplateColumn>	
				    
                                    <asp:TemplateColumn>
                                        <HeaderTemplate>
                                            Family Name
                                        </HeaderTemplate>
                                        <ItemTemplate>
                                            <%# DataBinder.Eval(Container.DataItem, "DisplayName") %>
                                        </ItemTemplate>
                                        <ItemStyle Width="25%" />
                                    </asp:TemplateColumn>	
                                    <asp:TemplateColumn>
                                        <HeaderTemplate>
                                            Father Name
                                        </HeaderTemplate>
                                        <ItemTemplate>
                                            <%# DataBinder.Eval(Container.DataItem, "FatherName") %>
                                        </ItemTemplate>
                                        <ItemStyle Width="17%" />
                                    </asp:TemplateColumn>	
                                    <asp:TemplateColumn>
                                        <HeaderTemplate>
                                            Mother Name
                                        </HeaderTemplate>
                                        <ItemTemplate>
                                            <%# DataBinder.Eval(Container.DataItem, "MotherName") %>
                                        </ItemTemplate>
                                        <ItemStyle Width="17%" />
                                    </asp:TemplateColumn>	
                                    <asp:TemplateColumn>
                                        <HeaderTemplate>
                                            Contact Number
                                        </HeaderTemplate>
                                        <ItemTemplate>
                                            <%# DataBinder.Eval(Container.DataItem, "CellNumber") %>
                                        </ItemTemplate>
                                        <ItemStyle Width="15%" />
                                    </asp:TemplateColumn>
                                    <asp:TemplateColumn>
                                        <HeaderTemplate>
                                            Total Students 
                                        </HeaderTemplate>
                                        <ItemTemplate>
                                            <%# DataBinder.Eval(Container.DataItem, "TotalChildren") %>
                                        </ItemTemplate>
                                        <ItemStyle Width="15%" />
                                    </asp:TemplateColumn>
                                </Columns>
                                <HeaderStyle BackColor="#6699CC" Font-Bold="False" Font-Italic="False" Font-Overline="False"
                                             Font-Strikeout="False" Font-Underline="False" />
                            </asp:DataGrid>
                            <%-- <br />--%>
                            <uc1:DataPager ID="pagerApps" runat="server" PageIndex="1" RecordsPerPage="100" TotalRecords="0" />
                        </td>
                        <td valign="top">
                            <table >
                                <tr ><td>
                                         <asp:Button ID="btnDetailsFamily" runat="server" Width="100%" Text="Family Details" OnClick="btnDetailsFamily_Click" />
                 
                                     </td></tr>
                                <tr ><td>
                                         <asp:Button ID="btnEditFamily" runat="server" Width="100%" Text="Edit Family" OnClick="btnEditFamily_Click" />
                 
                                     </td></tr>
        
                                <tr><td>
                                        <asp:Button ID="btnDelFamily" runat="server"  Width="100%" Text="Delete Family" OnClientClick = "return ValidateAction();" OnClick="btnDelFamily_Click" /></td></tr>
                            </table>
                        </td>
                    </tr>
                </table>
	        
                <script type="text/javascript" language="javascript">
                    SelectFirst('dgFamilies');

                </script>
          
                <table id="tbNoDataFound" runat="server" width="100%" visible="false">
                    <tr>
                        <td>No Family Found.</td>
                    </tr>
                </table>		
            </td>
        </tr> 
    </table>
</asp:Content>